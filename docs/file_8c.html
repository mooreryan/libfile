<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Ruby-like C: src/file.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Ruby-like C
   &#160;<span id="projectnumber">v0.1.0</span>
   </div>
   <div id="projectbrief">Provides common file and path manipulating functions.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">file.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>File containing functions like those found in Ruby's File class.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &quot;file.h&quot;</code><br />
<code>#include &quot;err_codes.h&quot;</code><br />
</div>
<p><a href="file_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0c6b293dc73a75c060d19f24cdddfb33"><td class="memItemLeft" align="right" valign="top"><a id="a0c6b293dc73a75c060d19f24cdddfb33"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>index_before_first_trailing_file_separator</b> (const char *fname)</td></tr>
<tr class="separator:a0c6b293dc73a75c060d19f24cdddfb33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6165db85a22043b7f7ecdd7ed8253e6e"><td class="memItemLeft" align="right" valign="top"><a id="a6165db85a22043b7f7ecdd7ed8253e6e"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>index_of_last_file_separator</b> (const char *fname)</td></tr>
<tr class="separator:a6165db85a22043b7f7ecdd7ed8253e6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a476de51c34c40242a7a2a75537d0344e"><td class="memItemLeft" align="right" valign="top"><a id="a476de51c34c40242a7a2a75537d0344e"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>index_of_last_file_separator_from_pos</b> (const char *fname, int pos)</td></tr>
<tr class="separator:a476de51c34c40242a7a2a75537d0344e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7168dc89a86d32848ea303ae9c2ac942"><td class="memItemLeft" align="right" valign="top"><a id="a7168dc89a86d32848ea303ae9c2ac942"></a>
char *&#160;</td><td class="memItemRight" valign="bottom"><b>make_simple_string</b> (char c)</td></tr>
<tr class="separator:a7168dc89a86d32848ea303ae9c2ac942"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17657bd78fd92f6d396585a63b8d4139"><td class="memItemLeft" align="right" valign="top"><a id="a17657bd78fd92f6d396585a63b8d4139"></a>
char *&#160;</td><td class="memItemRight" valign="bottom"><b>make_empty_string</b> (void)</td></tr>
<tr class="separator:a17657bd78fd92f6d396585a63b8d4139"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5c486c6bb46d7d0c5ba43e8b80d541f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#ae5c486c6bb46d7d0c5ba43e8b80d541f">file_is_directory</a> (const char *fname)</td></tr>
<tr class="memdesc:ae5c486c6bb46d7d0c5ba43e8b80d541f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the named file is a directory, and false otherwise.  <a href="#ae5c486c6bb46d7d0c5ba43e8b80d541f">More...</a><br /></td></tr>
<tr class="separator:ae5c486c6bb46d7d0c5ba43e8b80d541f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa39b7fc580815a0ae1d03655cdf667f8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#aa39b7fc580815a0ae1d03655cdf667f8">file_is_file</a> (const char *fname)</td></tr>
<tr class="memdesc:aa39b7fc580815a0ae1d03655cdf667f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the named file exists and is a regular file, and false otherwise.  <a href="#aa39b7fc580815a0ae1d03655cdf667f8">More...</a><br /></td></tr>
<tr class="separator:aa39b7fc580815a0ae1d03655cdf667f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3fb24244f77793acd8a3eabf7bdca36"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#ac3fb24244f77793acd8a3eabf7bdca36">file_dirname</a> (const char *fname)</td></tr>
<tr class="memdesc:ac3fb24244f77793acd8a3eabf7bdca36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the dirname of a file.  <a href="#ac3fb24244f77793acd8a3eabf7bdca36">More...</a><br /></td></tr>
<tr class="separator:ac3fb24244f77793acd8a3eabf7bdca36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8e27458de2b6242059dd9408772c55d"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#ac8e27458de2b6242059dd9408772c55d">file_basename</a> (const char *fname)</td></tr>
<tr class="memdesc:ac8e27458de2b6242059dd9408772c55d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the basename of a file.  <a href="#ac8e27458de2b6242059dd9408772c55d">More...</a><br /></td></tr>
<tr class="separator:ac8e27458de2b6242059dd9408772c55d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a259e7362730847fdba82df77eee9a019"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#a259e7362730847fdba82df77eee9a019">file_extname</a> (const char *fname)</td></tr>
<tr class="memdesc:a259e7362730847fdba82df77eee9a019"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the extension of a file.  <a href="#a259e7362730847fdba82df77eee9a019">More...</a><br /></td></tr>
<tr class="separator:a259e7362730847fdba82df77eee9a019"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b6851acc397da843264f644334202b5"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#a1b6851acc397da843264f644334202b5">file_join</a> (const char **strings, int num_strings)</td></tr>
<tr class="memdesc:a1b6851acc397da843264f644334202b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a new path by joining the strings using the FILE_SEPARATOR.  <a href="#a1b6851acc397da843264f644334202b5">More...</a><br /></td></tr>
<tr class="separator:a1b6851acc397da843264f644334202b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>File containing functions like those found in Ruby's File class. </p>
<dl class="section author"><dt>Author</dt><dd>Ryan Moore </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://ruby-doc.org/core-2.5.0/File.html">https://ruby-doc.org/core-2.5.0/File.html</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="file_8c_source.html">file.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ac8e27458de2b6242059dd9408772c55d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8e27458de2b6242059dd9408772c55d">&#9670;&nbsp;</a></span>file_basename()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* file_basename </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the basename of a file. </p>
<div class="fragment"><div class="line"><span class="keywordtype">char</span>* extname = <a class="code" href="file_8c.html#a259e7362730847fdba82df77eee9a019">file_extname</a>(<span class="stringliteral">&quot;/apple/pie&quot;</span>);</div></div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fname</td><td>The file name or the path. NULL is returned if param is NULL. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The basename of the file or path or NULL if there were errors.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The caller must free the return value. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The caller must check the return value for NULL.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>Ruby's also takes an optional second param for extname to strip. </dd></dl>

<p class="definition">Definition at line <a class="el" href="file_8c_source.html#l00238">238</a> of file <a class="el" href="file_8c_source.html">file.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;{</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">if</span> (fname == NULL) { <span class="keywordflow">return</span> NULL; }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordtype">int</span> i                = 0;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordtype">int</span> i_last_fs        = 0;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keywordtype">int</span> i_basename_start = 0;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordtype">size_t</span> slen         = strlen(fname);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordtype">size_t</span> basename_len = 0;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordtype">char</span>* basename = NULL;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="comment">/* If we are passed an empty string.... */</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">if</span> (slen == 0) {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    basename = make_empty_string();</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">return</span> basename;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  }</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  i = index_before_first_trailing_file_separator(fname);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordflow">if</span> (i &lt; 0) {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">/* This can only happen for names like &quot;////&quot; */</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    assert(fname[0] == FILE_SEPARATOR);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    basename = make_simple_string(FILE_SEPARATOR);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  }</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">/* The current index points to the char just before the first of</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">       trailing FILE_SEPARATOR chars if there are any, so the trailing</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">       FILE_SEPARATORs begin at i + 1. */</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    i_last_fs = i + 1;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">for</span> (i = i_last_fs - 1; i &gt;= 0; --i) {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keywordflow">if</span> (fname[i] == FILE_SEPARATOR) {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    i_basename_start = i + 1;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    basename_len     = i_last_fs - i_basename_start;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    basename = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * (basename_len + 1));</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordflow">if</span> (basename == NULL) { <span class="keywordflow">return</span> NULL; }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; basename_len; ++i) {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      basename[i] = fname[i + i_basename_start];</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    }</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    basename[basename_len] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  }</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keywordflow">return</span> basename;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="ac3fb24244f77793acd8a3eabf7bdca36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3fb24244f77793acd8a3eabf7bdca36">&#9670;&nbsp;</a></span>file_dirname()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* file_dirname </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the dirname of a file. </p>
<p>Returns all components of the filename given in file_name except the last one (after first stripping trailing separators).</p>
<div class="fragment"><div class="line">TEST_ASSERT_EQUAL_STRING(<span class="stringliteral">&quot;/apple&quot;</span>, <a class="code" href="file_8c.html#ac3fb24244f77793acd8a3eabf7bdca36">file_dirname</a>(<span class="stringliteral">&quot;/apple/pie.txt&quot;</span>));</div></div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fname</td><td>The file name or the path. NULL is returned if param is NULL. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The dirname of the file or path or NULL if there were errors.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The caller must free the return value. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The caller must check the return value for NULL. </dd></dl>

<p class="definition">Definition at line <a class="el" href="file_8c_source.html#l00172">172</a> of file <a class="el" href="file_8c_source.html">file.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;{</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">if</span> (fname == NULL) { <span class="keywordflow">return</span> NULL; }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordtype">size_t</span> slen = strlen(fname);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordtype">char</span>* dirname = NULL;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordflow">if</span> (slen == 0) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    dirname = make_empty_string();</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">return</span> dirname;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  i = index_of_last_file_separator(fname);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">if</span> (i &lt; 0 &amp;&amp; fname[0] == FILE_SEPARATOR) {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">/* Filenames like: &quot;/////&quot; */</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    dirname = make_simple_string(FILE_SEPARATOR);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  }</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &lt; 0) {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">/* Filenames like: &quot;apple&quot; */</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    dirname = make_simple_string(<span class="charliteral">&#39;.&#39;</span>);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">/* There was a basename.  Now we need to make sure that there</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">       aren&#39;t a bunch of fs chars right in a row. */</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    i = index_of_last_file_separator_from_pos(fname, i);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span> (i &lt;= 0) {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="comment">/* This could happen for filenames like: &quot;/////apple&quot; or &quot;/apple&quot; */</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      dirname = make_simple_string(FILE_SEPARATOR);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keywordtype">int</span> i_before_last_fs = i - 1;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      dirname = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * (i_before_last_fs + 2));</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keywordflow">if</span> (dirname == NULL) { <span class="keywordflow">return</span> NULL; }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      strncpy(dirname, fname, i_before_last_fs + 1);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      dirname[i_before_last_fs + 1] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    }</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  }</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keywordflow">return</span> dirname;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a259e7362730847fdba82df77eee9a019"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a259e7362730847fdba82df77eee9a019">&#9670;&nbsp;</a></span>file_extname()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* file_extname </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the extension of a file. </p>
<div class="fragment"><div class="line"><span class="keywordtype">char</span>* extname = <a class="code" href="file_8c.html#a259e7362730847fdba82df77eee9a019">file_extname</a>(<span class="stringliteral">&quot;/apple/pie&quot;</span>);</div></div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fname</td><td>The file name or the path. NULL is returned if param is NULL. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The extension of the file or path or NULL if there were errors.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The caller must free the return value. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The caller must check the return value for NULL. </dd></dl>

<p class="definition">Definition at line <a class="el" href="file_8c_source.html#l00307">307</a> of file <a class="el" href="file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="file_8c_source.html#l00238">file_basename()</a>.</p>
<div class="fragment"><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;{</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keywordflow">if</span> (fname == NULL) { <span class="keywordflow">return</span> NULL; }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordtype">size_t</span> basename_len = 0;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordtype">char</span>* basename = NULL;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordtype">char</span>* extname  = NULL;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordtype">char</span>* last_dot = NULL;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  basename     = <a class="code" href="file_8c.html#ac8e27458de2b6242059dd9408772c55d">file_basename</a>(fname);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">if</span> (basename == NULL) { <span class="keywordflow">return</span> NULL; }</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  basename_len = strlen(basename);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  last_dot = strrchr(basename, <span class="charliteral">&#39;.&#39;</span>);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">if</span> (<span class="comment">/* No &#39;.&#39; was found */</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      (last_dot == NULL) ||</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="comment">/* The last dot was the first char: &quot;.profile&quot; */</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      (last_dot == basename) ||</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="comment">/* If the dot was the last thing in the fname: &quot;foo.&quot; */</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      (*last_dot == basename[basename_len - 1])) {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    extname = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * 2);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">if</span> (extname == NULL) { <span class="keywordflow">return</span> NULL; }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    strncpy(extname, <span class="stringliteral">&quot;&quot;</span>, 1);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    extname[1] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  }</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    extname = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * (basename_len + 1));</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">if</span> (extname == NULL) { <span class="keywordflow">return</span> NULL; }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    strncpy(extname, last_dot, basename_len);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    extname[basename_len] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  free(basename);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keywordflow">return</span> extname;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;}</div><div class="ttc" id="file_8c_html_ac8e27458de2b6242059dd9408772c55d"><div class="ttname"><a href="file_8c.html#ac8e27458de2b6242059dd9408772c55d">file_basename</a></div><div class="ttdeci">char * file_basename(const char *fname)</div><div class="ttdoc">Return the basename of a file. </div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00238">file.c:238</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5c486c6bb46d7d0c5ba43e8b80d541f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5c486c6bb46d7d0c5ba43e8b80d541f">&#9670;&nbsp;</a></span>file_is_directory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int file_is_directory </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if the named file is a directory, and false otherwise. </p>
<div class="fragment"><div class="line">mkdir(<span class="stringliteral">&quot;apple&quot;</span>, S_IRUSR | S_IWUSR | S_IXUSR);</div><div class="line">TEST_ASSERT_TRUE(<a class="code" href="file_8c.html#ae5c486c6bb46d7d0c5ba43e8b80d541f">file_is_directory</a>(<span class="stringliteral">&quot;apple&quot;</span>));</div><div class="line"></div><div class="line">rmdir(<span class="stringliteral">&quot;apple&quot;</span>);</div><div class="line">TEST_ASSERT_FALSE(<a class="code" href="file_8c.html#ae5c486c6bb46d7d0c5ba43e8b80d541f">file_is_directory</a>(<span class="stringliteral">&quot;apple&quot;</span>));</div><div class="line"></div><div class="line">TEST_ASSERT_FALSE(<a class="code" href="file_8c.html#ae5c486c6bb46d7d0c5ba43e8b80d541f">file_is_directory</a>(NULL));</div></div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fname</td><td>The file name or the path. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if fname is a directory, 0 otherwise. If the fname was NULL, 0 is returned.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>Ruby also returns true if fname is a symlink that points at a directory. </dd></dl>

<p class="definition">Definition at line <a class="el" href="file_8c_source.html#l00108">108</a> of file <a class="el" href="file_8c_source.html">file.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;{</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">if</span> (fname == NULL) { <span class="keywordflow">return</span> 0; }</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keyword">struct </span>stat st;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordflow">if</span> (stat(fname, &amp;st) &lt; 0) {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">return</span> S_ISDIR(st.st_mode);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="aa39b7fc580815a0ae1d03655cdf667f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa39b7fc580815a0ae1d03655cdf667f8">&#9670;&nbsp;</a></span>file_is_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int file_is_file </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if the named file exists and is a regular file, and false otherwise. </p>
<div class="fragment"><div class="line">TEST_ASSERT_TRUE(<a class="code" href="file_8c.html#aa39b7fc580815a0ae1d03655cdf667f8">file_is_file</a>(<span class="stringliteral">&quot;file.h&quot;</span>));</div><div class="line"></div><div class="line"><span class="keyword">remove</span>(<span class="stringliteral">&quot;file.h&quot;</span>);</div><div class="line">TEST_ASSERT_FALSE(<a class="code" href="file_8c.html#aa39b7fc580815a0ae1d03655cdf667f8">file_is_file</a>(<span class="stringliteral">&quot;file.h&quot;</span>));</div><div class="line"></div><div class="line">TEST_ASSERT_FALSE(<a class="code" href="file_8c.html#aa39b7fc580815a0ae1d03655cdf667f8">file_is_file</a>(NULL));</div></div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fname</td><td>The file name or the path. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if file exists and is regular file. If the fname was NULL, 0 is returned.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>Ruby also returns true if fname is a symlink that points at a file. </dd></dl>

<p class="definition">Definition at line <a class="el" href="file_8c_source.html#l00141">141</a> of file <a class="el" href="file_8c_source.html">file.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;{</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordflow">if</span> (fname == NULL) { <span class="keywordflow">return</span> 0; }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keyword">struct </span>stat st;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">if</span> (stat(fname, &amp;st) &lt; 0) {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">return</span> S_ISREG(st.st_mode);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a1b6851acc397da843264f644334202b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b6851acc397da843264f644334202b5">&#9670;&nbsp;</a></span>file_join()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* file_join </td>
          <td>(</td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>strings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_strings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a new path by joining the strings using the FILE_SEPARATOR. </p>
<div class="fragment"><div class="line"><span class="keywordtype">char</span>* actual = NULL;</div><div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span>* strings1[3] = { <span class="stringliteral">&quot;apple&quot;</span>, <span class="stringliteral">&quot;pie&quot;</span>, <span class="stringliteral">&quot;good&quot;</span> };</div><div class="line"></div><div class="line">TEST_ASSERT_EQUAL_STRING(<span class="stringliteral">&quot;apple/pie/good&quot;</span>, (actual = <a class="code" href="file_8c.html#a1b6851acc397da843264f644334202b5">file_join</a>(strings1, 3)));</div><div class="line"></div><div class="line">free(actual);</div></div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">strings</td><td>Array of char arrays </td></tr>
    <tr><td class="paramname">num_strings</td><td>The number of elems in the strings array</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The path or NULL if there are errors or any of the strings are NULL or the strings array itself is null.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Ruby has some weird behavior here where it sometimes keeps double // and sometimes it doesn't. It doesn't in cases where there is more than one slash in a single one of the input strings. Regardless, the function is for building paths so in that spirit, we don't want those double separators anyways. Soooo, it differs from Ruby in these cases.</dd>
<dd>
The caller must free the return value. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The caller must check the return value for NULL.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd><p class="startdd">the no_doubles path will use a bit more memory than it actually needs if some of the double // are removed. </p>
<p class="enddd">Clean this up... </p>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="file_8c_source.html#l00379">379</a> of file <a class="el" href="file_8c_source.html">file.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;{</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keywordflow">if</span> (strings == NULL) { <span class="keywordflow">return</span> NULL; }</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordflow">if</span> (num_strings &lt; 1) { <span class="keywordflow">return</span> NULL; }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keywordtype">int</span> j = 0;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">/* Include enough space for the number of file_separators as well as</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">     the null char */</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keywordtype">int</span> path_len = num_strings;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordtype">char</span>* path = NULL;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; num_strings; ++i) {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">if</span> (strings[i] == NULL) { <span class="keywordflow">return</span> NULL; }</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    path_len += strlen(strings[i]);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  path = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * path_len);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="keywordflow">if</span> (path == NULL) { <span class="keywordflow">return</span> NULL; }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keywordtype">int</span> total_i = 0;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; num_strings; ++i) {</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">if</span> (strlen(strings[i]) &gt; 0) {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; strlen(strings[i]); ++j) {</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        path[total_i++] = strings[i][j];</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      }</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">if</span> (i &lt; num_strings - 1) {</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      path[total_i++] = FILE_SEPARATOR;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  }</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  path[total_i++] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordtype">char</span>* no_doubles = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * (total_i + 1));</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordflow">if</span> (no_doubles == NULL) { <span class="keywordflow">return</span> NULL; }</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  j = 0;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  no_doubles[j++] = path[0];</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordflow">for</span> (i = 1; i &lt; total_i-1; ++i) {</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">if</span> (path[i] != FILE_SEPARATOR ||</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        (path[i] == FILE_SEPARATOR &amp;&amp; path[i-1] != FILE_SEPARATOR)) {</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      no_doubles[j++] = path[i];</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    }</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  }</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  no_doubles[j++] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  free(path);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="keywordflow">return</span> no_doubles;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
