/* This file was autogenerated with generate_tests.rb.  Do not edit manually. */
#include <stdlib.h>
#include "unity.h"
#include "helper.h"
#include "rlib.h"

#define TEST_ASSERT_EQUAL_RSTRING_MESSAGE(expected, actual, msg) TEST_ASSERT_TRUE_MESSAGE(biseqcstr((const_bstring)actual, expected), msg)
void
test___rfile_basename(void)
{
  rstring* actual = NULL;
  rstring* rstr = NULL;


  actual = rfile_basename((rstr = rstring_new("foo")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo", actual, "Path: 'foo'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext", actual, "Path: 'foo.ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo ", actual, "Path: 'foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .ext", actual, "Path: 'foo .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.", actual, "Path: 'foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo..ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..ext", actual, "Path: 'foo..ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext ", actual, "Path: 'foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.ext .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .ext", actual, "Path: 'foo.ext .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo ", actual, "Path: 'foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext ", actual, "Path: 'foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo  ", actual, "Path: 'foo  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .ext ", actual, "Path: 'foo .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo. ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo. ", actual, "Path: 'foo. '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo..ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..ext ", actual, "Path: 'foo..ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.ext  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext  ", actual, "Path: 'foo.ext  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.ext .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .ext ", actual, "Path: 'foo.ext .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.", actual, "Path: 'foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext.", actual, "Path: 'foo.ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .", actual, "Path: 'foo .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .ext.", actual, "Path: 'foo .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo..")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..", actual, "Path: 'foo..'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo..ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..ext.", actual, "Path: 'foo..ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.ext .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .", actual, "Path: 'foo.ext .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.ext .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .ext.", actual, "Path: 'foo.ext .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.bar", actual, "Path: 'foo.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext.bar", actual, "Path: 'foo.ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .bar", actual, "Path: 'foo .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .ext.bar", actual, "Path: 'foo .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo..bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..bar", actual, "Path: 'foo..bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo..ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..ext.bar", actual, "Path: 'foo..ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.ext .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .bar", actual, "Path: 'foo.ext .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.ext .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .ext.bar", actual, "Path: 'foo.ext .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo::$DATA", actual, "Path: 'foo::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext::$DATA", actual, "Path: 'foo.ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo ::$DATA", actual, "Path: 'foo ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .ext::$DATA", actual, "Path: 'foo .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.::$DATA", actual, "Path: 'foo.::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo..ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..ext::$DATA", actual, "Path: 'foo..ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.ext ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext ::$DATA", actual, "Path: 'foo.ext ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.ext .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .ext::$DATA", actual, "Path: 'foo.ext .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo::$DATA.bar", actual, "Path: 'foo::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext::$DATA.bar", actual, "Path: 'foo.ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo ::$DATA.bar", actual, "Path: 'foo ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .ext::$DATA.bar", actual, "Path: 'foo .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.::$DATA.bar", actual, "Path: 'foo.::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo..ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..ext::$DATA.bar", actual, "Path: 'foo..ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.ext ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext ::$DATA.bar", actual, "Path: 'foo.ext ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("foo.ext .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .ext::$DATA.bar", actual, "Path: 'foo.ext .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo", actual, "Path: '//foo'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext", actual, "Path: '//foo.ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo ", actual, "Path: '//foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .ext", actual, "Path: '//foo .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.", actual, "Path: '//foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo..ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..ext", actual, "Path: '//foo..ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext ", actual, "Path: '//foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.ext .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .ext", actual, "Path: '//foo.ext .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo ", actual, "Path: '//foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext ", actual, "Path: '//foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo  ", actual, "Path: '//foo  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .ext ", actual, "Path: '//foo .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo. ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo. ", actual, "Path: '//foo. '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo..ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..ext ", actual, "Path: '//foo..ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.ext  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext  ", actual, "Path: '//foo.ext  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.ext .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .ext ", actual, "Path: '//foo.ext .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.", actual, "Path: '//foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext.", actual, "Path: '//foo.ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .", actual, "Path: '//foo .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .ext.", actual, "Path: '//foo .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo..")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..", actual, "Path: '//foo..'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo..ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..ext.", actual, "Path: '//foo..ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.ext .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .", actual, "Path: '//foo.ext .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.ext .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .ext.", actual, "Path: '//foo.ext .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.bar", actual, "Path: '//foo.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext.bar", actual, "Path: '//foo.ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .bar", actual, "Path: '//foo .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .ext.bar", actual, "Path: '//foo .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo..bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..bar", actual, "Path: '//foo..bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo..ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..ext.bar", actual, "Path: '//foo..ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.ext .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .bar", actual, "Path: '//foo.ext .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.ext .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .ext.bar", actual, "Path: '//foo.ext .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo::$DATA", actual, "Path: '//foo::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext::$DATA", actual, "Path: '//foo.ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo ::$DATA", actual, "Path: '//foo ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .ext::$DATA", actual, "Path: '//foo .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.::$DATA", actual, "Path: '//foo.::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo..ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..ext::$DATA", actual, "Path: '//foo..ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.ext ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext ::$DATA", actual, "Path: '//foo.ext ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.ext .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .ext::$DATA", actual, "Path: '//foo.ext .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo::$DATA.bar", actual, "Path: '//foo::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext::$DATA.bar", actual, "Path: '//foo.ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo ::$DATA.bar", actual, "Path: '//foo ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .ext::$DATA.bar", actual, "Path: '//foo .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.::$DATA.bar", actual, "Path: '//foo.::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo..ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..ext::$DATA.bar", actual, "Path: '//foo..ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.ext ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext ::$DATA.bar", actual, "Path: '//foo.ext ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("//foo.ext .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .ext::$DATA.bar", actual, "Path: '//foo.ext .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo", actual, "Path: '/foo'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext", actual, "Path: '/foo.ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo ", actual, "Path: '/foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .ext", actual, "Path: '/foo .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.", actual, "Path: '/foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo..ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..ext", actual, "Path: '/foo..ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext ", actual, "Path: '/foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.ext .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .ext", actual, "Path: '/foo.ext .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo ", actual, "Path: '/foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext ", actual, "Path: '/foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo  ", actual, "Path: '/foo  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .ext ", actual, "Path: '/foo .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo. ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo. ", actual, "Path: '/foo. '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo..ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..ext ", actual, "Path: '/foo..ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.ext  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext  ", actual, "Path: '/foo.ext  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.ext .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .ext ", actual, "Path: '/foo.ext .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.", actual, "Path: '/foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext.", actual, "Path: '/foo.ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .", actual, "Path: '/foo .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .ext.", actual, "Path: '/foo .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo..")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..", actual, "Path: '/foo..'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo..ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..ext.", actual, "Path: '/foo..ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.ext .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .", actual, "Path: '/foo.ext .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.ext .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .ext.", actual, "Path: '/foo.ext .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.bar", actual, "Path: '/foo.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext.bar", actual, "Path: '/foo.ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .bar", actual, "Path: '/foo .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .ext.bar", actual, "Path: '/foo .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo..bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..bar", actual, "Path: '/foo..bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo..ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..ext.bar", actual, "Path: '/foo..ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.ext .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .bar", actual, "Path: '/foo.ext .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.ext .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .ext.bar", actual, "Path: '/foo.ext .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo::$DATA", actual, "Path: '/foo::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext::$DATA", actual, "Path: '/foo.ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo ::$DATA", actual, "Path: '/foo ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .ext::$DATA", actual, "Path: '/foo .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.::$DATA", actual, "Path: '/foo.::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo..ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..ext::$DATA", actual, "Path: '/foo..ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.ext ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext ::$DATA", actual, "Path: '/foo.ext ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.ext .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .ext::$DATA", actual, "Path: '/foo.ext .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo::$DATA.bar", actual, "Path: '/foo::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext::$DATA.bar", actual, "Path: '/foo.ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo ::$DATA.bar", actual, "Path: '/foo ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo .ext::$DATA.bar", actual, "Path: '/foo .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.::$DATA.bar", actual, "Path: '/foo.::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo..ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo..ext::$DATA.bar", actual, "Path: '/foo..ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.ext ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext ::$DATA.bar", actual, "Path: '/foo.ext ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/foo.ext .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("foo.ext .ext::$DATA.bar", actual, "Path: '/foo.ext .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo", actual, "Path: '.foo'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext", actual, "Path: '.foo.ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo ", actual, "Path: '.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext", actual, "Path: '.foo .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.", actual, "Path: '.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo..ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext", actual, "Path: '.foo..ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext ", actual, "Path: '.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.ext .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext", actual, "Path: '.foo.ext .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo ", actual, "Path: '.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext ", actual, "Path: '.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo  ", actual, "Path: '.foo  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext ", actual, "Path: '.foo .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo. ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo. ", actual, "Path: '.foo. '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo..ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext ", actual, "Path: '.foo..ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.ext  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext  ", actual, "Path: '.foo.ext  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.ext .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext ", actual, "Path: '.foo.ext .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.", actual, "Path: '.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext.", actual, "Path: '.foo.ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .", actual, "Path: '.foo .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext.", actual, "Path: '.foo .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo..")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..", actual, "Path: '.foo..'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo..ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext.", actual, "Path: '.foo..ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.ext .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .", actual, "Path: '.foo.ext .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.ext .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext.", actual, "Path: '.foo.ext .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.bar", actual, "Path: '.foo.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext.bar", actual, "Path: '.foo.ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .bar", actual, "Path: '.foo .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext.bar", actual, "Path: '.foo .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo..bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..bar", actual, "Path: '.foo..bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo..ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext.bar", actual, "Path: '.foo..ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.ext .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .bar", actual, "Path: '.foo.ext .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.ext .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext.bar", actual, "Path: '.foo.ext .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo::$DATA", actual, "Path: '.foo::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext::$DATA", actual, "Path: '.foo.ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo ::$DATA", actual, "Path: '.foo ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext::$DATA", actual, "Path: '.foo .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.::$DATA", actual, "Path: '.foo.::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo..ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext::$DATA", actual, "Path: '.foo..ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.ext ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext ::$DATA", actual, "Path: '.foo.ext ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.ext .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext::$DATA", actual, "Path: '.foo.ext .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo::$DATA.bar", actual, "Path: '.foo::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext::$DATA.bar", actual, "Path: '.foo.ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo ::$DATA.bar", actual, "Path: '.foo ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext::$DATA.bar", actual, "Path: '.foo .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.::$DATA.bar", actual, "Path: '.foo.::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo..ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext::$DATA.bar", actual, "Path: '.foo..ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.ext ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext ::$DATA.bar", actual, "Path: '.foo.ext ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new(".foo.ext .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext::$DATA.bar", actual, "Path: '.foo.ext .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo", actual, "Path: '/.foo'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext", actual, "Path: '/.foo.ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo ", actual, "Path: '/.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext", actual, "Path: '/.foo .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.", actual, "Path: '/.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo..ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext", actual, "Path: '/.foo..ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext ", actual, "Path: '/.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.ext .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext", actual, "Path: '/.foo.ext .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo ", actual, "Path: '/.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext ", actual, "Path: '/.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo  ", actual, "Path: '/.foo  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext ", actual, "Path: '/.foo .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo. ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo. ", actual, "Path: '/.foo. '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo..ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext ", actual, "Path: '/.foo..ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.ext  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext  ", actual, "Path: '/.foo.ext  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.ext .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext ", actual, "Path: '/.foo.ext .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.", actual, "Path: '/.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext.", actual, "Path: '/.foo.ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .", actual, "Path: '/.foo .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext.", actual, "Path: '/.foo .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo..")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..", actual, "Path: '/.foo..'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo..ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext.", actual, "Path: '/.foo..ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.ext .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .", actual, "Path: '/.foo.ext .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.ext .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext.", actual, "Path: '/.foo.ext .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.bar", actual, "Path: '/.foo.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext.bar", actual, "Path: '/.foo.ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .bar", actual, "Path: '/.foo .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext.bar", actual, "Path: '/.foo .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo..bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..bar", actual, "Path: '/.foo..bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo..ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext.bar", actual, "Path: '/.foo..ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.ext .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .bar", actual, "Path: '/.foo.ext .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.ext .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext.bar", actual, "Path: '/.foo.ext .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo::$DATA", actual, "Path: '/.foo::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext::$DATA", actual, "Path: '/.foo.ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo ::$DATA", actual, "Path: '/.foo ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext::$DATA", actual, "Path: '/.foo .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.::$DATA", actual, "Path: '/.foo.::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo..ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext::$DATA", actual, "Path: '/.foo..ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.ext ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext ::$DATA", actual, "Path: '/.foo.ext ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.ext .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext::$DATA", actual, "Path: '/.foo.ext .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo::$DATA.bar", actual, "Path: '/.foo::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext::$DATA.bar", actual, "Path: '/.foo.ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo ::$DATA.bar", actual, "Path: '/.foo ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext::$DATA.bar", actual, "Path: '/.foo .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.::$DATA.bar", actual, "Path: '/.foo.::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo..ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext::$DATA.bar", actual, "Path: '/.foo..ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.ext ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext ::$DATA.bar", actual, "Path: '/.foo.ext ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/.foo.ext .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext::$DATA.bar", actual, "Path: '/.foo.ext .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo", actual, "Path: 'bar/.foo'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext", actual, "Path: 'bar/.foo.ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo ", actual, "Path: 'bar/.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext", actual, "Path: 'bar/.foo .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.", actual, "Path: 'bar/.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo..ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext", actual, "Path: 'bar/.foo..ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext ", actual, "Path: 'bar/.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.ext .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext", actual, "Path: 'bar/.foo.ext .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo ", actual, "Path: 'bar/.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext ", actual, "Path: 'bar/.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo  ", actual, "Path: 'bar/.foo  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext ", actual, "Path: 'bar/.foo .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo. ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo. ", actual, "Path: 'bar/.foo. '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo..ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext ", actual, "Path: 'bar/.foo..ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.ext  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext  ", actual, "Path: 'bar/.foo.ext  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.ext .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext ", actual, "Path: 'bar/.foo.ext .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.", actual, "Path: 'bar/.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext.", actual, "Path: 'bar/.foo.ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .", actual, "Path: 'bar/.foo .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext.", actual, "Path: 'bar/.foo .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo..")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..", actual, "Path: 'bar/.foo..'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo..ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext.", actual, "Path: 'bar/.foo..ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.ext .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .", actual, "Path: 'bar/.foo.ext .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.ext .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext.", actual, "Path: 'bar/.foo.ext .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.bar", actual, "Path: 'bar/.foo.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext.bar", actual, "Path: 'bar/.foo.ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .bar", actual, "Path: 'bar/.foo .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext.bar", actual, "Path: 'bar/.foo .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo..bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..bar", actual, "Path: 'bar/.foo..bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo..ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext.bar", actual, "Path: 'bar/.foo..ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.ext .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .bar", actual, "Path: 'bar/.foo.ext .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.ext .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext.bar", actual, "Path: 'bar/.foo.ext .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo::$DATA", actual, "Path: 'bar/.foo::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext::$DATA", actual, "Path: 'bar/.foo.ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo ::$DATA", actual, "Path: 'bar/.foo ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext::$DATA", actual, "Path: 'bar/.foo .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.::$DATA", actual, "Path: 'bar/.foo.::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo..ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext::$DATA", actual, "Path: 'bar/.foo..ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.ext ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext ::$DATA", actual, "Path: 'bar/.foo.ext ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.ext .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext::$DATA", actual, "Path: 'bar/.foo.ext .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo::$DATA.bar", actual, "Path: 'bar/.foo::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext::$DATA.bar", actual, "Path: 'bar/.foo.ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo ::$DATA.bar", actual, "Path: 'bar/.foo ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext::$DATA.bar", actual, "Path: 'bar/.foo .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.::$DATA.bar", actual, "Path: 'bar/.foo.::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo..ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext::$DATA.bar", actual, "Path: 'bar/.foo..ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.ext ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext ::$DATA.bar", actual, "Path: 'bar/.foo.ext ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("bar/.foo.ext .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext::$DATA.bar", actual, "Path: 'bar/.foo.ext .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo", actual, "Path: '/bar/.foo'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext", actual, "Path: '/bar/.foo.ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo ", actual, "Path: '/bar/.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext", actual, "Path: '/bar/.foo .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.", actual, "Path: '/bar/.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo..ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext", actual, "Path: '/bar/.foo..ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext ", actual, "Path: '/bar/.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.ext .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext", actual, "Path: '/bar/.foo.ext .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo ", actual, "Path: '/bar/.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext ", actual, "Path: '/bar/.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo  ", actual, "Path: '/bar/.foo  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext ", actual, "Path: '/bar/.foo .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo. ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo. ", actual, "Path: '/bar/.foo. '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo..ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext ", actual, "Path: '/bar/.foo..ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.ext  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext  ", actual, "Path: '/bar/.foo.ext  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.ext .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext ", actual, "Path: '/bar/.foo.ext .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.", actual, "Path: '/bar/.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext.", actual, "Path: '/bar/.foo.ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .", actual, "Path: '/bar/.foo .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext.", actual, "Path: '/bar/.foo .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo..")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..", actual, "Path: '/bar/.foo..'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo..ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext.", actual, "Path: '/bar/.foo..ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.ext .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .", actual, "Path: '/bar/.foo.ext .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.ext .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext.", actual, "Path: '/bar/.foo.ext .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.bar", actual, "Path: '/bar/.foo.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext.bar", actual, "Path: '/bar/.foo.ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .bar", actual, "Path: '/bar/.foo .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext.bar", actual, "Path: '/bar/.foo .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo..bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..bar", actual, "Path: '/bar/.foo..bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo..ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext.bar", actual, "Path: '/bar/.foo..ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.ext .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .bar", actual, "Path: '/bar/.foo.ext .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.ext .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext.bar", actual, "Path: '/bar/.foo.ext .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo::$DATA", actual, "Path: '/bar/.foo::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext::$DATA", actual, "Path: '/bar/.foo.ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo ::$DATA", actual, "Path: '/bar/.foo ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext::$DATA", actual, "Path: '/bar/.foo .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.::$DATA", actual, "Path: '/bar/.foo.::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo..ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext::$DATA", actual, "Path: '/bar/.foo..ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.ext ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext ::$DATA", actual, "Path: '/bar/.foo.ext ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.ext .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext::$DATA", actual, "Path: '/bar/.foo.ext .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo::$DATA.bar", actual, "Path: '/bar/.foo::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext::$DATA.bar", actual, "Path: '/bar/.foo.ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo ::$DATA.bar", actual, "Path: '/bar/.foo ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo .ext::$DATA.bar", actual, "Path: '/bar/.foo .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.::$DATA.bar", actual, "Path: '/bar/.foo.::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo..ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo..ext::$DATA.bar", actual, "Path: '/bar/.foo..ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.ext ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext ::$DATA.bar", actual, "Path: '/bar/.foo.ext ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_basename((rstr = rstring_new("/bar/.foo.ext .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".foo.ext .ext::$DATA.bar", actual, "Path: '/bar/.foo.ext .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);
}

void
test___rfile_dirname(void)
{
  rstring* actual = NULL;
  rstring* rstr = NULL;


  actual = rfile_dirname((rstr = rstring_new("foo")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo..ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo..ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.ext .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.ext .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo. ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo. '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo..ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo..ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.ext  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.ext  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.ext .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.ext .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo..")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo..'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo..ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo..ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.ext .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.ext .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.ext .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.ext .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo..bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo..bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo..ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo..ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.ext .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.ext .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.ext .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.ext .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo..ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo..ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.ext ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.ext ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.ext .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.ext .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo..ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo..ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.ext ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.ext ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("foo.ext .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: 'foo.ext .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo..ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo..ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.ext .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.ext .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo. ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo. '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo..ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo..ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.ext  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.ext  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.ext .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.ext .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo..")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo..'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo..ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo..ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.ext .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.ext .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.ext .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.ext .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo..bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo..bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo..ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo..ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.ext .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.ext .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.ext .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.ext .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo..ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo..ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.ext ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.ext ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.ext .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.ext .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo..ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo..ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.ext ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.ext ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("//foo.ext .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '//foo.ext .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo..ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo..ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.ext .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.ext .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo. ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo. '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo..ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo..ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.ext  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.ext  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.ext .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.ext .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo..")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo..'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo..ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo..ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.ext .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.ext .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.ext .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.ext .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo..bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo..bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo..ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo..ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.ext .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.ext .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.ext .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.ext .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo..ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo..ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.ext ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.ext ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.ext .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.ext .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo..ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo..ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.ext ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.ext ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/foo.ext .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/foo.ext .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo..ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo..ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.ext .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.ext .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo. ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo. '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo..ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo..ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.ext  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.ext  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.ext .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.ext .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo..")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo..'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo..ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo..ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.ext .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.ext .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.ext .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.ext .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo..bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo..bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo..ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo..ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.ext .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.ext .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.ext .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.ext .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo..ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo..ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.ext ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.ext ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.ext .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.ext .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo..ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo..ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.ext ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.ext ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new(".foo.ext .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".", actual, "Path: '.foo.ext .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo..ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo..ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.ext .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.ext .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo. ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo. '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo..ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo..ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.ext  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.ext  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.ext .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.ext .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo..")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo..'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo..ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo..ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.ext .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.ext .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.ext .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.ext .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo..bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo..bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo..ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo..ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.ext .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.ext .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.ext .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.ext .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo..ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo..ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.ext ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.ext ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.ext .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.ext .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo..ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo..ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.ext ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.ext ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/.foo.ext .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", actual, "Path: '/.foo.ext .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo..ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo..ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.ext .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.ext .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo. ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo. '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo..ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo..ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.ext  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.ext  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.ext .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.ext .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo..")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo..'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo..ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo..ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.ext .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.ext .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.ext .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.ext .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo..bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo..bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo..ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo..ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.ext .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.ext .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.ext .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.ext .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo..ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo..ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.ext ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.ext ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.ext .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.ext .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo..ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo..ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.ext ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.ext ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("bar/.foo.ext .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("bar", actual, "Path: 'bar/.foo.ext .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo..ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo..ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.ext .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.ext .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo. ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo. '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo..ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo..ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.ext  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.ext  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.ext .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.ext .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo..")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo..'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo..ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo..ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.ext .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.ext .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.ext .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.ext .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo..bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo..bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo..ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo..ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.ext .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.ext .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.ext .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.ext .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo..ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo..ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.ext ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.ext ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.ext .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.ext .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo..ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo..ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.ext ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.ext ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_dirname((rstr = rstring_new("/bar/.foo.ext .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/bar", actual, "Path: '/bar/.foo.ext .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);
}

void
test___rfile_extname(void)
{
  rstring* actual = NULL;
  rstring* rstr = NULL;


  actual = rfile_extname((rstr = rstring_new("foo")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'foo'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: 'foo.ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: 'foo .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo..ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: 'foo..ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: 'foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.ext .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: 'foo.ext .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: 'foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'foo  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: 'foo .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo. ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(". ", actual, "Path: 'foo. '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo..ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: 'foo..ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.ext  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext  ", actual, "Path: 'foo.ext  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.ext .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: 'foo.ext .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'foo.ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'foo .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'foo .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo..")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'foo..'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo..ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'foo..ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.ext .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'foo.ext .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.ext .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'foo.ext .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'foo.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'foo.ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'foo .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'foo .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo..bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'foo..bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo..ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'foo..ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.ext .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'foo.ext .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.ext .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'foo.ext .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'foo::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: 'foo.ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'foo ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: 'foo .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".::$DATA", actual, "Path: 'foo.::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo..ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: 'foo..ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.ext ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ::$DATA", actual, "Path: 'foo.ext ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.ext .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: 'foo.ext .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'foo::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'foo.ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'foo ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'foo .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'foo.::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo..ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'foo..ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.ext ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'foo.ext ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("foo.ext .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'foo.ext .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '//foo'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: '//foo.ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '//foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: '//foo .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '//foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo..ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: '//foo..ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '//foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.ext .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: '//foo.ext .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '//foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '//foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '//foo  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '//foo .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo. ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(". ", actual, "Path: '//foo. '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo..ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '//foo..ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.ext  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext  ", actual, "Path: '//foo.ext  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.ext .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '//foo.ext .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '//foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '//foo.ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '//foo .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '//foo .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo..")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '//foo..'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo..ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '//foo..ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.ext .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '//foo.ext .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.ext .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '//foo.ext .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '//foo.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '//foo.ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '//foo .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '//foo .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo..bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '//foo..bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo..ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '//foo..ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.ext .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '//foo.ext .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.ext .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '//foo.ext .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '//foo::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: '//foo.ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '//foo ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: '//foo .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".::$DATA", actual, "Path: '//foo.::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo..ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: '//foo..ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.ext ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ::$DATA", actual, "Path: '//foo.ext ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.ext .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: '//foo.ext .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '//foo::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '//foo.ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '//foo ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '//foo .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '//foo.::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo..ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '//foo..ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.ext ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '//foo.ext ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("//foo.ext .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '//foo.ext .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/foo'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: '/foo.ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: '/foo .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo..ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: '/foo..ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '/foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.ext .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: '/foo.ext .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '/foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/foo  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '/foo .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo. ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(". ", actual, "Path: '/foo. '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo..ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '/foo..ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.ext  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext  ", actual, "Path: '/foo.ext  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.ext .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '/foo.ext .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/foo.ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/foo .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/foo .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo..")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/foo..'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo..ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/foo..ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.ext .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/foo.ext .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.ext .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/foo.ext .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/foo.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/foo.ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/foo .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/foo .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo..bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/foo..bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo..ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/foo..ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.ext .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/foo.ext .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.ext .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/foo.ext .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/foo::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: '/foo.ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/foo ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: '/foo .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".::$DATA", actual, "Path: '/foo.::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo..ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: '/foo..ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.ext ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ::$DATA", actual, "Path: '/foo.ext ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.ext .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: '/foo.ext .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/foo::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/foo.ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/foo ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/foo .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/foo.::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo..ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/foo..ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.ext ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/foo.ext ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/foo.ext .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/foo.ext .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '.foo'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: '.foo.ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: '.foo .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo..ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: '.foo..ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.ext .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: '.foo.ext .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '.foo  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '.foo .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo. ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(". ", actual, "Path: '.foo. '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo..ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '.foo..ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.ext  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext  ", actual, "Path: '.foo.ext  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.ext .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '.foo.ext .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '.foo.ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '.foo .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '.foo .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo..")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '.foo..'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo..ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '.foo..ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.ext .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '.foo.ext .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.ext .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '.foo.ext .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '.foo.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '.foo.ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '.foo .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '.foo .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo..bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '.foo..bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo..ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '.foo..ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.ext .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '.foo.ext .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.ext .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '.foo.ext .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '.foo::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: '.foo.ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '.foo ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: '.foo .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".::$DATA", actual, "Path: '.foo.::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo..ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: '.foo..ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.ext ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ::$DATA", actual, "Path: '.foo.ext ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.ext .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: '.foo.ext .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '.foo::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '.foo.ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '.foo ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '.foo .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '.foo.::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo..ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '.foo..ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.ext ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '.foo.ext ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new(".foo.ext .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '.foo.ext .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/.foo'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: '/.foo.ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: '/.foo .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo..ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: '/.foo..ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '/.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.ext .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: '/.foo.ext .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '/.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/.foo  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '/.foo .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo. ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(". ", actual, "Path: '/.foo. '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo..ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '/.foo..ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.ext  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext  ", actual, "Path: '/.foo.ext  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.ext .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '/.foo.ext .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/.foo.ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/.foo .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/.foo .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo..")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/.foo..'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo..ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/.foo..ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.ext .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/.foo.ext .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.ext .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/.foo.ext .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/.foo.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/.foo.ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/.foo .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/.foo .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo..bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/.foo..bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo..ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/.foo..ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.ext .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/.foo.ext .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.ext .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/.foo.ext .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/.foo::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: '/.foo.ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/.foo ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: '/.foo .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".::$DATA", actual, "Path: '/.foo.::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo..ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: '/.foo..ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.ext ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ::$DATA", actual, "Path: '/.foo.ext ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.ext .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: '/.foo.ext .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/.foo::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/.foo.ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/.foo ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/.foo .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/.foo.::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo..ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/.foo..ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.ext ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/.foo.ext ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/.foo.ext .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/.foo.ext .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'bar/.foo'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: 'bar/.foo.ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'bar/.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: 'bar/.foo .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'bar/.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo..ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: 'bar/.foo..ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: 'bar/.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.ext .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: 'bar/.foo.ext .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'bar/.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: 'bar/.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'bar/.foo  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: 'bar/.foo .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo. ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(". ", actual, "Path: 'bar/.foo. '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo..ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: 'bar/.foo..ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.ext  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext  ", actual, "Path: 'bar/.foo.ext  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.ext .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: 'bar/.foo.ext .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'bar/.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'bar/.foo.ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'bar/.foo .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'bar/.foo .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo..")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'bar/.foo..'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo..ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'bar/.foo..ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.ext .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'bar/.foo.ext .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.ext .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'bar/.foo.ext .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'bar/.foo.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'bar/.foo.ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'bar/.foo .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'bar/.foo .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo..bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'bar/.foo..bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo..ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'bar/.foo..ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.ext .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'bar/.foo.ext .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.ext .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'bar/.foo.ext .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'bar/.foo::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: 'bar/.foo.ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: 'bar/.foo ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: 'bar/.foo .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".::$DATA", actual, "Path: 'bar/.foo.::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo..ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: 'bar/.foo..ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.ext ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ::$DATA", actual, "Path: 'bar/.foo.ext ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.ext .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: 'bar/.foo.ext .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'bar/.foo::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'bar/.foo.ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'bar/.foo ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'bar/.foo .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'bar/.foo.::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo..ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'bar/.foo..ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.ext ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'bar/.foo.ext ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("bar/.foo.ext .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: 'bar/.foo.ext .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/bar/.foo'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: '/bar/.foo.ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/bar/.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: '/bar/.foo .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/bar/.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo..ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: '/bar/.foo..ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '/bar/.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.ext .ext")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext", actual, "Path: '/bar/.foo.ext .ext'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/bar/.foo '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '/bar/.foo.ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/bar/.foo  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '/bar/.foo .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo. ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(". ", actual, "Path: '/bar/.foo. '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo..ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '/bar/.foo..ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.ext  ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext  ", actual, "Path: '/bar/.foo.ext  '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.ext .ext ")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ", actual, "Path: '/bar/.foo.ext .ext '");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/bar/.foo.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/bar/.foo.ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/bar/.foo .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/bar/.foo .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo..")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/bar/.foo..'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo..ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/bar/.foo..ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.ext .")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/bar/.foo.ext .'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.ext .ext.")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/bar/.foo.ext .ext.'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/bar/.foo.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/bar/.foo.ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/bar/.foo .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/bar/.foo .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo..bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/bar/.foo..bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo..ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/bar/.foo..ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.ext .bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/bar/.foo.ext .bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.ext .ext.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/bar/.foo.ext .ext.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/bar/.foo::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: '/bar/.foo.ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("", actual, "Path: '/bar/.foo ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: '/bar/.foo .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".::$DATA", actual, "Path: '/bar/.foo.::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo..ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: '/bar/.foo..ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.ext ::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext ::$DATA", actual, "Path: '/bar/.foo.ext ::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.ext .ext::$DATA")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".ext::$DATA", actual, "Path: '/bar/.foo.ext .ext::$DATA'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/bar/.foo::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/bar/.foo.ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/bar/.foo ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/bar/.foo .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/bar/.foo.::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo..ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/bar/.foo..ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.ext ::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/bar/.foo.ext ::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);

  actual = rfile_extname((rstr = rstring_new("/bar/.foo.ext .ext::$DATA.bar")));
  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".bar", actual, "Path: '/bar/.foo.ext .ext::$DATA.bar'");
  rstring_free(actual);
  rstring_free(rstr);
}


void
test___rfile_join(void)
{
  rstring* actual = NULL;
  rstring_array* rary = NULL;


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "1");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ ", (actual = rfile_join(rary)), "2");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  ", (actual = rfile_join(rary)), "3");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/.", (actual = rfile_join(rary)), "4");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/..", (actual = rfile_join(rary)), "5");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "6");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "7");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/good", (actual = rfile_join(rary)), "8");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ /", (actual = rfile_join(rary)), "9");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ / ", (actual = rfile_join(rary)), "10");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ /  ", (actual = rfile_join(rary)), "11");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ /.", (actual = rfile_join(rary)), "12");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ /..", (actual = rfile_join(rary)), "13");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ /", (actual = rfile_join(rary)), "14");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ /", (actual = rfile_join(rary)), "15");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ /good", (actual = rfile_join(rary)), "16");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  /", (actual = rfile_join(rary)), "17");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  / ", (actual = rfile_join(rary)), "18");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  /  ", (actual = rfile_join(rary)), "19");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  /.", (actual = rfile_join(rary)), "20");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  /..", (actual = rfile_join(rary)), "21");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  /", (actual = rfile_join(rary)), "22");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  /", (actual = rfile_join(rary)), "23");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  /good", (actual = rfile_join(rary)), "24");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./", (actual = rfile_join(rary)), "25");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./ ", (actual = rfile_join(rary)), "26");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./  ", (actual = rfile_join(rary)), "27");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./.", (actual = rfile_join(rary)), "28");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./..", (actual = rfile_join(rary)), "29");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./", (actual = rfile_join(rary)), "30");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./", (actual = rfile_join(rary)), "31");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./good", (actual = rfile_join(rary)), "32");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../", (actual = rfile_join(rary)), "33");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../ ", (actual = rfile_join(rary)), "34");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../  ", (actual = rfile_join(rary)), "35");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../.", (actual = rfile_join(rary)), "36");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../..", (actual = rfile_join(rary)), "37");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../", (actual = rfile_join(rary)), "38");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../", (actual = rfile_join(rary)), "39");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../good", (actual = rfile_join(rary)), "40");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "41");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ ", (actual = rfile_join(rary)), "42");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  ", (actual = rfile_join(rary)), "43");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/.", (actual = rfile_join(rary)), "44");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/..", (actual = rfile_join(rary)), "45");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "46");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "47");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/good", (actual = rfile_join(rary)), "48");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "49");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ ", (actual = rfile_join(rary)), "50");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  ", (actual = rfile_join(rary)), "51");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/.", (actual = rfile_join(rary)), "52");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/..", (actual = rfile_join(rary)), "53");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "54");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "55");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/good", (actual = rfile_join(rary)), "56");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/", (actual = rfile_join(rary)), "57");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/ ", (actual = rfile_join(rary)), "58");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/  ", (actual = rfile_join(rary)), "59");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/.", (actual = rfile_join(rary)), "60");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/..", (actual = rfile_join(rary)), "61");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/", (actual = rfile_join(rary)), "62");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/", (actual = rfile_join(rary)), "63");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/good", (actual = rfile_join(rary)), "64");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /", (actual = rfile_join(rary)), "65");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" / ", (actual = rfile_join(rary)), "66");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /  ", (actual = rfile_join(rary)), "67");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /.", (actual = rfile_join(rary)), "68");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /..", (actual = rfile_join(rary)), "69");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /", (actual = rfile_join(rary)), "70");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /", (actual = rfile_join(rary)), "71");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /good", (actual = rfile_join(rary)), "72");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" / /", (actual = rfile_join(rary)), "73");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" / / ", (actual = rfile_join(rary)), "74");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" / /  ", (actual = rfile_join(rary)), "75");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" / /.", (actual = rfile_join(rary)), "76");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" / /..", (actual = rfile_join(rary)), "77");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" / /", (actual = rfile_join(rary)), "78");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" / /", (actual = rfile_join(rary)), "79");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" / /good", (actual = rfile_join(rary)), "80");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /  /", (actual = rfile_join(rary)), "81");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /  / ", (actual = rfile_join(rary)), "82");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /  /  ", (actual = rfile_join(rary)), "83");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /  /.", (actual = rfile_join(rary)), "84");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /  /..", (actual = rfile_join(rary)), "85");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /  /", (actual = rfile_join(rary)), "86");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /  /", (actual = rfile_join(rary)), "87");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /  /good", (actual = rfile_join(rary)), "88");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /./", (actual = rfile_join(rary)), "89");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /./ ", (actual = rfile_join(rary)), "90");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /./  ", (actual = rfile_join(rary)), "91");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /./.", (actual = rfile_join(rary)), "92");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /./..", (actual = rfile_join(rary)), "93");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /./", (actual = rfile_join(rary)), "94");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /./", (actual = rfile_join(rary)), "95");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /./good", (actual = rfile_join(rary)), "96");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /../", (actual = rfile_join(rary)), "97");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /../ ", (actual = rfile_join(rary)), "98");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /../  ", (actual = rfile_join(rary)), "99");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /../.", (actual = rfile_join(rary)), "100");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /../..", (actual = rfile_join(rary)), "101");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /../", (actual = rfile_join(rary)), "102");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /../", (actual = rfile_join(rary)), "103");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /../good", (actual = rfile_join(rary)), "104");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /", (actual = rfile_join(rary)), "105");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" / ", (actual = rfile_join(rary)), "106");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /  ", (actual = rfile_join(rary)), "107");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /.", (actual = rfile_join(rary)), "108");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /..", (actual = rfile_join(rary)), "109");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /", (actual = rfile_join(rary)), "110");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /", (actual = rfile_join(rary)), "111");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /good", (actual = rfile_join(rary)), "112");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /", (actual = rfile_join(rary)), "113");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" / ", (actual = rfile_join(rary)), "114");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /  ", (actual = rfile_join(rary)), "115");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /.", (actual = rfile_join(rary)), "116");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /..", (actual = rfile_join(rary)), "117");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /", (actual = rfile_join(rary)), "118");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /", (actual = rfile_join(rary)), "119");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /good", (actual = rfile_join(rary)), "120");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /pie/", (actual = rfile_join(rary)), "121");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /pie/ ", (actual = rfile_join(rary)), "122");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /pie/  ", (actual = rfile_join(rary)), "123");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /pie/.", (actual = rfile_join(rary)), "124");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /pie/..", (actual = rfile_join(rary)), "125");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /pie/", (actual = rfile_join(rary)), "126");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /pie/", (actual = rfile_join(rary)), "127");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(" /pie/good", (actual = rfile_join(rary)), "128");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /", (actual = rfile_join(rary)), "129");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  / ", (actual = rfile_join(rary)), "130");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /  ", (actual = rfile_join(rary)), "131");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /.", (actual = rfile_join(rary)), "132");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /..", (actual = rfile_join(rary)), "133");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /", (actual = rfile_join(rary)), "134");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /", (actual = rfile_join(rary)), "135");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /good", (actual = rfile_join(rary)), "136");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  / /", (actual = rfile_join(rary)), "137");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  / / ", (actual = rfile_join(rary)), "138");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  / /  ", (actual = rfile_join(rary)), "139");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  / /.", (actual = rfile_join(rary)), "140");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  / /..", (actual = rfile_join(rary)), "141");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  / /", (actual = rfile_join(rary)), "142");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  / /", (actual = rfile_join(rary)), "143");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  / /good", (actual = rfile_join(rary)), "144");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /  /", (actual = rfile_join(rary)), "145");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /  / ", (actual = rfile_join(rary)), "146");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /  /  ", (actual = rfile_join(rary)), "147");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /  /.", (actual = rfile_join(rary)), "148");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /  /..", (actual = rfile_join(rary)), "149");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /  /", (actual = rfile_join(rary)), "150");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /  /", (actual = rfile_join(rary)), "151");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /  /good", (actual = rfile_join(rary)), "152");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /./", (actual = rfile_join(rary)), "153");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /./ ", (actual = rfile_join(rary)), "154");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /./  ", (actual = rfile_join(rary)), "155");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /./.", (actual = rfile_join(rary)), "156");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /./..", (actual = rfile_join(rary)), "157");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /./", (actual = rfile_join(rary)), "158");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /./", (actual = rfile_join(rary)), "159");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /./good", (actual = rfile_join(rary)), "160");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /../", (actual = rfile_join(rary)), "161");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /../ ", (actual = rfile_join(rary)), "162");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /../  ", (actual = rfile_join(rary)), "163");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /../.", (actual = rfile_join(rary)), "164");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /../..", (actual = rfile_join(rary)), "165");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /../", (actual = rfile_join(rary)), "166");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /../", (actual = rfile_join(rary)), "167");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /../good", (actual = rfile_join(rary)), "168");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /", (actual = rfile_join(rary)), "169");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  / ", (actual = rfile_join(rary)), "170");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /  ", (actual = rfile_join(rary)), "171");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /.", (actual = rfile_join(rary)), "172");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /..", (actual = rfile_join(rary)), "173");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /", (actual = rfile_join(rary)), "174");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /", (actual = rfile_join(rary)), "175");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /good", (actual = rfile_join(rary)), "176");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /", (actual = rfile_join(rary)), "177");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  / ", (actual = rfile_join(rary)), "178");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /  ", (actual = rfile_join(rary)), "179");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /.", (actual = rfile_join(rary)), "180");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /..", (actual = rfile_join(rary)), "181");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /", (actual = rfile_join(rary)), "182");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /", (actual = rfile_join(rary)), "183");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /good", (actual = rfile_join(rary)), "184");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /pie/", (actual = rfile_join(rary)), "185");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /pie/ ", (actual = rfile_join(rary)), "186");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /pie/  ", (actual = rfile_join(rary)), "187");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /pie/.", (actual = rfile_join(rary)), "188");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /pie/..", (actual = rfile_join(rary)), "189");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /pie/", (actual = rfile_join(rary)), "190");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /pie/", (actual = rfile_join(rary)), "191");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("  /pie/good", (actual = rfile_join(rary)), "192");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./", (actual = rfile_join(rary)), "193");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./ ", (actual = rfile_join(rary)), "194");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./  ", (actual = rfile_join(rary)), "195");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./.", (actual = rfile_join(rary)), "196");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./..", (actual = rfile_join(rary)), "197");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./", (actual = rfile_join(rary)), "198");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./", (actual = rfile_join(rary)), "199");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./good", (actual = rfile_join(rary)), "200");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./ /", (actual = rfile_join(rary)), "201");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./ / ", (actual = rfile_join(rary)), "202");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./ /  ", (actual = rfile_join(rary)), "203");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./ /.", (actual = rfile_join(rary)), "204");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./ /..", (actual = rfile_join(rary)), "205");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./ /", (actual = rfile_join(rary)), "206");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./ /", (actual = rfile_join(rary)), "207");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./ /good", (actual = rfile_join(rary)), "208");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./  /", (actual = rfile_join(rary)), "209");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./  / ", (actual = rfile_join(rary)), "210");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./  /  ", (actual = rfile_join(rary)), "211");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./  /.", (actual = rfile_join(rary)), "212");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./  /..", (actual = rfile_join(rary)), "213");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./  /", (actual = rfile_join(rary)), "214");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./  /", (actual = rfile_join(rary)), "215");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./  /good", (actual = rfile_join(rary)), "216");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("././", (actual = rfile_join(rary)), "217");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("././ ", (actual = rfile_join(rary)), "218");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("././  ", (actual = rfile_join(rary)), "219");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("././.", (actual = rfile_join(rary)), "220");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("././..", (actual = rfile_join(rary)), "221");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("././", (actual = rfile_join(rary)), "222");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("././", (actual = rfile_join(rary)), "223");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("././good", (actual = rfile_join(rary)), "224");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./../", (actual = rfile_join(rary)), "225");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./../ ", (actual = rfile_join(rary)), "226");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./../  ", (actual = rfile_join(rary)), "227");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./../.", (actual = rfile_join(rary)), "228");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./../..", (actual = rfile_join(rary)), "229");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./../", (actual = rfile_join(rary)), "230");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./../", (actual = rfile_join(rary)), "231");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./../good", (actual = rfile_join(rary)), "232");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./", (actual = rfile_join(rary)), "233");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./ ", (actual = rfile_join(rary)), "234");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./  ", (actual = rfile_join(rary)), "235");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./.", (actual = rfile_join(rary)), "236");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./..", (actual = rfile_join(rary)), "237");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./", (actual = rfile_join(rary)), "238");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./", (actual = rfile_join(rary)), "239");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./good", (actual = rfile_join(rary)), "240");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./", (actual = rfile_join(rary)), "241");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./ ", (actual = rfile_join(rary)), "242");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./  ", (actual = rfile_join(rary)), "243");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./.", (actual = rfile_join(rary)), "244");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./..", (actual = rfile_join(rary)), "245");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./", (actual = rfile_join(rary)), "246");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./", (actual = rfile_join(rary)), "247");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./good", (actual = rfile_join(rary)), "248");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./pie/", (actual = rfile_join(rary)), "249");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./pie/ ", (actual = rfile_join(rary)), "250");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./pie/  ", (actual = rfile_join(rary)), "251");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./pie/.", (actual = rfile_join(rary)), "252");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./pie/..", (actual = rfile_join(rary)), "253");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./pie/", (actual = rfile_join(rary)), "254");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./pie/", (actual = rfile_join(rary)), "255");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("./pie/good", (actual = rfile_join(rary)), "256");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../", (actual = rfile_join(rary)), "257");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../ ", (actual = rfile_join(rary)), "258");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../  ", (actual = rfile_join(rary)), "259");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../.", (actual = rfile_join(rary)), "260");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../..", (actual = rfile_join(rary)), "261");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../", (actual = rfile_join(rary)), "262");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../", (actual = rfile_join(rary)), "263");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../good", (actual = rfile_join(rary)), "264");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../ /", (actual = rfile_join(rary)), "265");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../ / ", (actual = rfile_join(rary)), "266");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../ /  ", (actual = rfile_join(rary)), "267");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../ /.", (actual = rfile_join(rary)), "268");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../ /..", (actual = rfile_join(rary)), "269");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../ /", (actual = rfile_join(rary)), "270");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../ /", (actual = rfile_join(rary)), "271");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../ /good", (actual = rfile_join(rary)), "272");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../  /", (actual = rfile_join(rary)), "273");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../  / ", (actual = rfile_join(rary)), "274");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../  /  ", (actual = rfile_join(rary)), "275");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../  /.", (actual = rfile_join(rary)), "276");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../  /..", (actual = rfile_join(rary)), "277");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../  /", (actual = rfile_join(rary)), "278");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../  /", (actual = rfile_join(rary)), "279");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../  /good", (actual = rfile_join(rary)), "280");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".././", (actual = rfile_join(rary)), "281");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".././ ", (actual = rfile_join(rary)), "282");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".././  ", (actual = rfile_join(rary)), "283");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".././.", (actual = rfile_join(rary)), "284");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".././..", (actual = rfile_join(rary)), "285");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".././", (actual = rfile_join(rary)), "286");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".././", (actual = rfile_join(rary)), "287");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE(".././good", (actual = rfile_join(rary)), "288");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../../", (actual = rfile_join(rary)), "289");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../../ ", (actual = rfile_join(rary)), "290");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../../  ", (actual = rfile_join(rary)), "291");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../../.", (actual = rfile_join(rary)), "292");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../../..", (actual = rfile_join(rary)), "293");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../../", (actual = rfile_join(rary)), "294");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../../", (actual = rfile_join(rary)), "295");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../../good", (actual = rfile_join(rary)), "296");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../", (actual = rfile_join(rary)), "297");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../ ", (actual = rfile_join(rary)), "298");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../  ", (actual = rfile_join(rary)), "299");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../.", (actual = rfile_join(rary)), "300");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../..", (actual = rfile_join(rary)), "301");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../", (actual = rfile_join(rary)), "302");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../", (actual = rfile_join(rary)), "303");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../good", (actual = rfile_join(rary)), "304");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../", (actual = rfile_join(rary)), "305");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../ ", (actual = rfile_join(rary)), "306");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../  ", (actual = rfile_join(rary)), "307");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../.", (actual = rfile_join(rary)), "308");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../..", (actual = rfile_join(rary)), "309");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../", (actual = rfile_join(rary)), "310");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../", (actual = rfile_join(rary)), "311");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../good", (actual = rfile_join(rary)), "312");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../pie/", (actual = rfile_join(rary)), "313");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../pie/ ", (actual = rfile_join(rary)), "314");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../pie/  ", (actual = rfile_join(rary)), "315");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../pie/.", (actual = rfile_join(rary)), "316");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../pie/..", (actual = rfile_join(rary)), "317");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../pie/", (actual = rfile_join(rary)), "318");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../pie/", (actual = rfile_join(rary)), "319");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("../pie/good", (actual = rfile_join(rary)), "320");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "321");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ ", (actual = rfile_join(rary)), "322");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  ", (actual = rfile_join(rary)), "323");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/.", (actual = rfile_join(rary)), "324");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/..", (actual = rfile_join(rary)), "325");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "326");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "327");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/good", (actual = rfile_join(rary)), "328");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ /", (actual = rfile_join(rary)), "329");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ / ", (actual = rfile_join(rary)), "330");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ /  ", (actual = rfile_join(rary)), "331");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ /.", (actual = rfile_join(rary)), "332");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ /..", (actual = rfile_join(rary)), "333");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ /", (actual = rfile_join(rary)), "334");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ /", (actual = rfile_join(rary)), "335");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ /good", (actual = rfile_join(rary)), "336");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  /", (actual = rfile_join(rary)), "337");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  / ", (actual = rfile_join(rary)), "338");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  /  ", (actual = rfile_join(rary)), "339");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  /.", (actual = rfile_join(rary)), "340");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  /..", (actual = rfile_join(rary)), "341");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  /", (actual = rfile_join(rary)), "342");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  /", (actual = rfile_join(rary)), "343");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  /good", (actual = rfile_join(rary)), "344");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./", (actual = rfile_join(rary)), "345");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./ ", (actual = rfile_join(rary)), "346");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./  ", (actual = rfile_join(rary)), "347");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./.", (actual = rfile_join(rary)), "348");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./..", (actual = rfile_join(rary)), "349");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./", (actual = rfile_join(rary)), "350");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./", (actual = rfile_join(rary)), "351");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./good", (actual = rfile_join(rary)), "352");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../", (actual = rfile_join(rary)), "353");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../ ", (actual = rfile_join(rary)), "354");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../  ", (actual = rfile_join(rary)), "355");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../.", (actual = rfile_join(rary)), "356");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../..", (actual = rfile_join(rary)), "357");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../", (actual = rfile_join(rary)), "358");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../", (actual = rfile_join(rary)), "359");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../good", (actual = rfile_join(rary)), "360");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "361");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ ", (actual = rfile_join(rary)), "362");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  ", (actual = rfile_join(rary)), "363");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/.", (actual = rfile_join(rary)), "364");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/..", (actual = rfile_join(rary)), "365");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "366");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "367");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/good", (actual = rfile_join(rary)), "368");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "369");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ ", (actual = rfile_join(rary)), "370");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  ", (actual = rfile_join(rary)), "371");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/.", (actual = rfile_join(rary)), "372");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/..", (actual = rfile_join(rary)), "373");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "374");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "375");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/good", (actual = rfile_join(rary)), "376");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/", (actual = rfile_join(rary)), "377");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/ ", (actual = rfile_join(rary)), "378");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/  ", (actual = rfile_join(rary)), "379");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/.", (actual = rfile_join(rary)), "380");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/..", (actual = rfile_join(rary)), "381");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/", (actual = rfile_join(rary)), "382");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/", (actual = rfile_join(rary)), "383");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/good", (actual = rfile_join(rary)), "384");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "385");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ ", (actual = rfile_join(rary)), "386");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  ", (actual = rfile_join(rary)), "387");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/.", (actual = rfile_join(rary)), "388");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/..", (actual = rfile_join(rary)), "389");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "390");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "391");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/good", (actual = rfile_join(rary)), "392");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ /", (actual = rfile_join(rary)), "393");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ / ", (actual = rfile_join(rary)), "394");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ /  ", (actual = rfile_join(rary)), "395");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ /.", (actual = rfile_join(rary)), "396");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ /..", (actual = rfile_join(rary)), "397");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ /", (actual = rfile_join(rary)), "398");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ /", (actual = rfile_join(rary)), "399");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ /good", (actual = rfile_join(rary)), "400");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  /", (actual = rfile_join(rary)), "401");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  / ", (actual = rfile_join(rary)), "402");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  /  ", (actual = rfile_join(rary)), "403");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  /.", (actual = rfile_join(rary)), "404");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  /..", (actual = rfile_join(rary)), "405");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  /", (actual = rfile_join(rary)), "406");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  /", (actual = rfile_join(rary)), "407");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  /good", (actual = rfile_join(rary)), "408");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./", (actual = rfile_join(rary)), "409");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./ ", (actual = rfile_join(rary)), "410");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./  ", (actual = rfile_join(rary)), "411");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./.", (actual = rfile_join(rary)), "412");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./..", (actual = rfile_join(rary)), "413");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./", (actual = rfile_join(rary)), "414");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./", (actual = rfile_join(rary)), "415");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/./good", (actual = rfile_join(rary)), "416");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../", (actual = rfile_join(rary)), "417");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../ ", (actual = rfile_join(rary)), "418");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../  ", (actual = rfile_join(rary)), "419");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../.", (actual = rfile_join(rary)), "420");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../..", (actual = rfile_join(rary)), "421");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../", (actual = rfile_join(rary)), "422");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../", (actual = rfile_join(rary)), "423");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/../good", (actual = rfile_join(rary)), "424");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "425");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ ", (actual = rfile_join(rary)), "426");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  ", (actual = rfile_join(rary)), "427");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/.", (actual = rfile_join(rary)), "428");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/..", (actual = rfile_join(rary)), "429");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "430");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "431");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/good", (actual = rfile_join(rary)), "432");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "433");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/ ", (actual = rfile_join(rary)), "434");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/  ", (actual = rfile_join(rary)), "435");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/.", (actual = rfile_join(rary)), "436");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/..", (actual = rfile_join(rary)), "437");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "438");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/", (actual = rfile_join(rary)), "439");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/good", (actual = rfile_join(rary)), "440");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/", (actual = rfile_join(rary)), "441");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/ ", (actual = rfile_join(rary)), "442");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/  ", (actual = rfile_join(rary)), "443");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/.", (actual = rfile_join(rary)), "444");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/..", (actual = rfile_join(rary)), "445");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/", (actual = rfile_join(rary)), "446");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/", (actual = rfile_join(rary)), "447");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("/pie/good", (actual = rfile_join(rary)), "448");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/", (actual = rfile_join(rary)), "449");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/ ", (actual = rfile_join(rary)), "450");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/  ", (actual = rfile_join(rary)), "451");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/.", (actual = rfile_join(rary)), "452");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/..", (actual = rfile_join(rary)), "453");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/", (actual = rfile_join(rary)), "454");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/", (actual = rfile_join(rary)), "455");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/good", (actual = rfile_join(rary)), "456");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/ /", (actual = rfile_join(rary)), "457");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/ / ", (actual = rfile_join(rary)), "458");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/ /  ", (actual = rfile_join(rary)), "459");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/ /.", (actual = rfile_join(rary)), "460");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/ /..", (actual = rfile_join(rary)), "461");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/ /", (actual = rfile_join(rary)), "462");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/ /", (actual = rfile_join(rary)), "463");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, " ");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/ /good", (actual = rfile_join(rary)), "464");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/  /", (actual = rfile_join(rary)), "465");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/  / ", (actual = rfile_join(rary)), "466");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/  /  ", (actual = rfile_join(rary)), "467");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/  /.", (actual = rfile_join(rary)), "468");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/  /..", (actual = rfile_join(rary)), "469");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/  /", (actual = rfile_join(rary)), "470");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/  /", (actual = rfile_join(rary)), "471");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "  ");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/  /good", (actual = rfile_join(rary)), "472");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/./", (actual = rfile_join(rary)), "473");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/./ ", (actual = rfile_join(rary)), "474");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/./  ", (actual = rfile_join(rary)), "475");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/./.", (actual = rfile_join(rary)), "476");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/./..", (actual = rfile_join(rary)), "477");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/./", (actual = rfile_join(rary)), "478");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/./", (actual = rfile_join(rary)), "479");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, ".");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/./good", (actual = rfile_join(rary)), "480");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/../", (actual = rfile_join(rary)), "481");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/../ ", (actual = rfile_join(rary)), "482");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/../  ", (actual = rfile_join(rary)), "483");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/../.", (actual = rfile_join(rary)), "484");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/../..", (actual = rfile_join(rary)), "485");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/../", (actual = rfile_join(rary)), "486");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/../", (actual = rfile_join(rary)), "487");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "..");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/../good", (actual = rfile_join(rary)), "488");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/", (actual = rfile_join(rary)), "489");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/ ", (actual = rfile_join(rary)), "490");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/  ", (actual = rfile_join(rary)), "491");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/.", (actual = rfile_join(rary)), "492");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/..", (actual = rfile_join(rary)), "493");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/", (actual = rfile_join(rary)), "494");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/", (actual = rfile_join(rary)), "495");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "/");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/good", (actual = rfile_join(rary)), "496");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/", (actual = rfile_join(rary)), "497");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/ ", (actual = rfile_join(rary)), "498");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/  ", (actual = rfile_join(rary)), "499");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/.", (actual = rfile_join(rary)), "500");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/..", (actual = rfile_join(rary)), "501");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/", (actual = rfile_join(rary)), "502");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/", (actual = rfile_join(rary)), "503");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "//");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/good", (actual = rfile_join(rary)), "504");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/pie/", (actual = rfile_join(rary)), "505");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, " ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/pie/ ", (actual = rfile_join(rary)), "506");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "  ");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/pie/  ", (actual = rfile_join(rary)), "507");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, ".");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/pie/.", (actual = rfile_join(rary)), "508");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "..");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/pie/..", (actual = rfile_join(rary)), "509");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "/");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/pie/", (actual = rfile_join(rary)), "510");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "//");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/pie/", (actual = rfile_join(rary)), "511");
  rstring_free(actual); rstring_array_free(rary);


  rary = rstring_array_new();
  rstring_array_push_cstr(rary, "apple");
  rstring_array_push_cstr(rary, "pie");
  rstring_array_push_cstr(rary, "good");

  TEST_ASSERT_EQUAL_RSTRING_MESSAGE("apple/pie/good", (actual = rfile_join(rary)), "512");
  rstring_free(actual); rstring_array_free(rary);
}
